# Reflection — UI: mobile/узкие, шапка (скрыть MAX WIN, расширить CHIPS/ANTE)

## Контекст задачи
На iPhone (Safari/Chrome) и узких ширинах верхняя шапка `CHIPS / MAX WIN / ANTE` ломалась:
- “MAX WIN 150.000x” был слишком крупным и визуально конфликтовал с соседними плашками.
- сумма в CHIPS могла обрезаться из-за ограниченной ширины + skew-эффекта.

## План vs факт
- **Планировали**: усилить адаптив — уменьшить `clamp()` на mobile, добавить `truncate/ellipsis`, при необходимости агрессивнее `formatMoneyAdaptive`.
- **Факт**: начали с адаптива (шрифты/сетку/overflow), затем столкнулись с регрессиями (runtime-ошибка и неудачная попытка container queries), после чего по фидбэку сделали **самое надёжное**: на mobile скрыли MAX WIN в шапке и сделали шапку двухколоночной (CHIPS/ANTE).

## Что сделали (по делу)
- `src/ui/screens/balatro-inferno/BalatroInferno.jsx`
  - На mobile (<640px) шапка теперь **2 колонки**: `CHIPS / ANTE`.
  - Центральный блок **MAX WIN скрыт** на mobile (`hidden sm:flex`), но остаётся на `sm+`.
  - Для CHIPS/ANTE добавлен `truncate` и снижены минимальные размеры шрифта на mobile.
  - Для mobile включён более агрессивный `formatMoneyAdaptive(...)`, чтобы длинные суммы раньше уходили в compact.

## Что было сложным / почему
- **Viewport-based адаптив (`vw`)** плохо коррелирует с доступной шириной центральной колонки: на больших mobile (Pro Max) текст может выглядеть “слишком большим”, даже если колонка уже.
- Попытка “умнее” масштабировать через container queries привела к неудачной настройке коэффициентов (визуально увеличивало текст “почти везде”) и потребовала отката.
- Поймали критичный регресс: `chipsDisplay` ссылался на `isMobileViewport` до объявления (TDZ → белый экран). Быстро исправили перестановкой `useState/useEffect`.

## Что сработало хорошо
- Простое правило **“убираем MAX WIN из шапки на mobile”**:
  - предсказуемо на всех телефонах,
  - сразу освобождает место CHIPS/ANTE,
  - минимизирует риск новых layout-багов.
- `truncate + title` остаётся хорошей страховкой для сумм.

## Что улучшить в процессе
- Для UI-правок, завязанных на размеры, держаться принципа: **сначала простое решение**, затем усложнение только при явной необходимости.
- При изменениях в React-компоненте избегать ссылок на переменные/хуки “ниже по файлу” (защита от TDZ/ошибок порядка инициализации).
- Если когда-нибудь вернём MAX WIN на mobile — лучше отдельный UX-паттерн (например, перенос в другой блок/вторая строка/иконка), а не “пытаться идеально отмасштабировать” одной формулой.


