# Reflection: AutoPlay (2025-12-21)

## Что было сделано
1. **AutoPlay механика**: реализован effect-оркестратор в `useBalatroInfernoController`, который последовательно запускает спины (после `idle`/`result`), останавливается при `CHIPS < ANTE` или невозможности старта.
2. **AutoPlay UI**: модалка выбора количества спинов (10/25/50/100/500/1000) и отображение статуса на кнопке `PLAY` (badge с обратным отсчётом).
3. **Безопасность**:
   - `START` в модалке превращается в `STOP` только на главной кнопке `AUTO` (разделение ответственности).
   - Защита от “гонок”: авто не стартует, если `isBusy`, и останавливается принудительно, если пользователь нажимает `PLAY` во время авто.
4. **Стиль (Pixel/CRT)**: после нескольких итераций модалка приведена к жёсткому стилю Balatro Inferno (CRT-сетка, двойные бордеры, пиксельные шрифты, shake-эффекты).

## Что изменилось в процессе
- Изначально планировали кнопку `∞` (бесконечно), но отказались от неё для упрощения UX и экономики.
- Дизайн модалки прошёл путь от “гладкой карточки” до “грубого CRT-терминала” с глитч-эффектами.
- Кнопка `START` в модалке была переделана, чтобы визуально копировать кнопку `PLAY` (для узнаваемости действия).
- Добавлены физические эффекты (`shake-violent`, `shake-ultra`) при клике на пресеты и старт.

## Технические детали
- **Orchestrator Effect**: вместо рекурсивных таймеров использовали `useEffect`, который следит за `gameState === 'idle' | 'result'`. Это оказалось надёжнее для синхронизации с React-рендером и каскадом.
- **ESLint**: пришлось локально отключить правило `react-hooks/set-state-in-effect` для оркестратора, так как его задача — именно запускать side-effect (спин) в ответ на state change.

## Выводы
- **Стиль превыше всего**: “стандартные” UI-компоненты (скруглённые модалки, мягкие тени) в этом проекте не работают. Нужно сразу делать pixel-perfect / CRT-style.
- **Micro-interactions**: добавление shake-эффектов на клики резко повышает ощущение “физичности” интерфейса.

